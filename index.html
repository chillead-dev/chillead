<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>alex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<main class="page">

  <section class="section">
    <h1># welcome!</h1>

    <p>
      hello! my name is <strong>alex</strong>.  
      i'm a developer who enjoys building things that simplify life,
      save time and feel clean to use.
    </p>

    <p>
      i mainly work with websites, backend logic and telegram bots,
      but i often experiment with other areas just for fun.
    </p>
  </section>

  <section class="section">
    <h2>## about</h2>

    <ul class="list">
      <li><span>name:</span> alex</li>
      <li><span>alive for:</span> <span id="alive"></span></li>
      <li><span>languages:</span> EN, RU</li>
      <li>
        <span>location:</span>
        Ekaterinburg, RU (<span id="time"></span>)
      </li>
      <li class="multiline">
        <span>occupation:</span>
        creating game cheats, websites,<br>
        telegram bots, parsers and checkers
      </li>
    </ul>
  </section>

  <section class="section">
    <h2>## background</h2>

    <p>
      i started programming in 2021 when i was only 11 years old.
      my first programming language was <strong>c++</strong>,
      which taught me how things actually work under the hood.
    </p>
  </section>

  <section class="section">
    <h2>## skills</h2>

    <ul class="list compact">
      <li>programming</li>
      <li>c++, javascript, typescript</li>
      <li>backend & websites</li>
      <li>telegram bots</li>
      <li>cats üêà</li>
    </ul>
  </section>

  <section class="section">
    <h2>## currently playing</h2>

    <p class="muted">
      this shows what i'm listening to on spotify right now.
      if nothing is playing, it will say so.
    </p>

    <div class="spotify-card" id="player">
      loading track data...
    </div>

    <p class="footnote">
      data may be delayed by a few seconds.
    </p>
  </section>

</main>

<script>
/* ===== alive counter ===== */
const birth = new Date("2010-08-05T00:00:00Z");
function updateAlive() {
  let diff = Math.floor((Date.now() - birth) / 1000);
  const y = Math.floor(diff / 31557600);
  diff -= y * 31557600;
  const d = Math.floor(diff / 86400);
  diff -= d * 86400;
  const h = Math.floor(diff / 3600);
  diff -= h * 3600;
  const m = Math.floor(diff / 60);
  const s = diff % 60;
  document.getElementById("alive").textContent =
    `${d + y * 365}d, ${h}h, ${m}m, ${s}s (${y}y)`;
}
updateAlive();
setInterval(updateAlive, 1000);

/* ===== local time ===== */
function updateTime() {
  document.getElementById("time").textContent =
    new Intl.DateTimeFormat("en-GB", {
      timeZone: "Asia/Yekaterinburg",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    }).format(new Date());
}
updateTime();
setInterval(updateTime, 1000);

/* ===== spotify ===== */
const player = document.getElementById("player");

async function loadNowPlaying() {
  try {
    const res = await fetch("/api/now-playing", { cache: "no-store" });
    const data = await res.json();

    if (!data || !data.playing) {
      player.textContent = "nothing is currently playing.";
      return;
    }

    const progress =
      Math.min(100, (data.progress / data.duration) * 100);

    player.innerHTML = `
      <div class="spotify-header">
        <img 
          src="https://upload.wikimedia.org/wikipedia/commons/8/84/Spotify_icon.svg"
          alt="Spotify"
          class="spotify-icon"
        >
        <span>listening on spotify</span>
      </div>

      <div class="track-title">${data.title}</div>
      <div class="track-artist">${data.artist}</div>

      <div class="progress">
        <div class="progress-fill" style="width:${progress}%"></div>
      </div>
    `;
  } catch {
    player.textContent = "failed to load track data.";
  }
}

loadNowPlaying();
setInterval(loadNowPlaying, 15000);
</script>

</body>
</html>
